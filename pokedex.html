<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokédex - The Ultimate Version</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* General Body Styles */
        body {
            font-family: 'Roboto Mono', monospace;
            background-color: #f0f0f0;
            color: #333;
            margin: 0;
            padding: 20px;
            text-align: center;
        }

        h1 {
            color: #e4000f;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        #loadingMessage {
            font-size: 1.2rem;
            color: #555;
        }

        /* Search Bar */
        .search-container {
            margin-bottom: 20px;
        }

        #searchInput {
            width: 80%;
            max-width: 400px;
            padding: 10px 15px;
            border: 2px solid #ccc;
            border-radius: 25px;
            font-size: 16px;
            font-family: 'Roboto Mono', monospace;
            outline: none;
            transition: border-color 0.3s;
        }

        #searchInput:focus {
            border-color: #e4000f;
        }

        /* Pokédex Container (Grid) */
        .pokedex-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Pokémon Card */
        .pokemon-card {
            background-color: #fff;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            padding: 20px;
            text-align: center;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .pokemon-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }

        .pokemon-card .pokemon-id {
            font-size: 14px;
            color: #888;
            font-weight: bold;
        }

        .pokemon-card img {
            width: 150px;
            height: 150px;
            margin: 10px auto;
            display: block;
        }

        .pokemon-card .pokemon-name {
            margin: 15px 0 10px;
            font-size: 22px;
            font-weight: bold;
            text-transform: capitalize;
        }

        /* Types Container */
        .pokemon-types {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }

        .type {
            padding: 5px 15px;
            border-radius: 15px;
            color: white;
            font-size: 14px;
            text-transform: uppercase;
            font-weight: bold;
        }

        /* Pokémon Type Colors */
        .type.normal { background-color: #A8A77A; }
        .type.fire { background-color: #EE8130; }
        .type.water { background-color: #6390F0; }
        .type.electric { background-color: #F7D02C; }
        .type.grass { background-color: #7AC74C; }
        .type.ice { background-color: #96D9D6; }
        .type.fighting { background-color: #C22E28; }
        .type.poison { background-color: #A33EA1; }
        .type.ground { background-color: #E2BF65; }
        .type.flying { background-color: #A98FF3; }
        .type.psychic { background-color: #F95587; }
        .type.bug { background-color: #A6B91A; }
        .type.rock { background-color: #B6A136; }
        .type.ghost { background-color: #735797; }
        .type.dragon { background-color: #6F35FC; }
        .type.dark { background-color: #705746; }
        .type.steel { background-color: #B7B7CE; }
        .type.fairy { background-color: #D685AD; }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: #fff;
            margin: 10% auto;
            padding: 30px;
            border: 1px solid #888;
            width: 80%;
            max-width: 600px;
            border-radius: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
            animation-name: animatetop;
            animation-duration: 0.4s;
            text-align: left;
        }

        @keyframes animatetop {
            from {top: -300px; opacity: 0}
            to {top: 0; opacity: 1}
        }

        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
        }

        .modal-info h2 {
            text-align: center;
            text-transform: capitalize;
            font-size: 2.5rem;
            margin-top: 0;
        }

        .modal-info .modal-id {
            font-size: 1.5rem;
            color: #888;
            text-align: center;
        }

        .modal-info .modal-image {
            display: block;
            margin: 0 auto 20px;
            width: 200px;
            height: 200px;
        }

        .modal-info .modal-types {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .modal-info .details p {
            margin: 5px 0;
        }

        .modal-info .stats-list {
            list-style-type: none;
            padding: 0;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .modal-info .stats-list li {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-info .stats-list span:first-child {
            font-weight: bold;
            text-transform: uppercase;
        }
    </style>
</head>
<body>

    <h1>Pokédex</h1>

    <div class="search-container">
        <input type="text" id="searchInput" placeholder="Search for a Pokémon...">
    </div>

    <p id="loadingMessage">Loading Pokédex...</p>

    <div id="pokedex-container" class="pokedex-container">
        </div>

    <div id="pokemonModal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <div id="modal-body">
                </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const pokedexContainer = document.getElementById('pokedex-container');
            const searchInput = document.getElementById('searchInput');
            const loadingMessage = document.getElementById('loadingMessage');
            const pokemonModal = document.getElementById('pokemonModal');
            const modalBody = document.getElementById('modal-body');
            const closeModal = document.querySelector('.close-button');

            let allPokemon = [];

            // Fetches data for a list of Pokémon from the main API endpoint
            const fetchAllPokemon = async () => {
                try {
                    const response = await fetch('https://pokeapi.co/api/v2/pokemon?limit=100000');
                    const data = await response.json();
                    const pokemonList = data.results;

                    const allPokemonPromises = pokemonList.map(async (pokemon) => {
                        const detailedResponse = await fetch(pokemon.url);
                        return detailedResponse.json();
                    });

                    allPokemon = await Promise.all(allPokemonPromises);
                    
                    // Hide loading message and display Pokémon
                    loadingMessage.style.display = 'none';
                    displayPokemon(allPokemon);

                } catch (error) {
                    console.error('Failed to fetch Pokémon data:', error);
                    loadingMessage.textContent = 'Failed to load Pokédex. Please try again later.';
                }
            };

            // Creates and displays the Pokémon cards on the main page
            const displayPokemon = (pokemonList) => {
                pokedexContainer.innerHTML = '';
                pokemonList.forEach(pokemon => {
                    const pokemonCard = document.createElement('div');
                    pokemonCard.classList.add('pokemon-card');
                    pokemonCard.setAttribute('data-id', pokemon.id);

                    const name = pokemon.name;
                    const id = pokemon.id.toString().padStart(3, '0');
                    const imageUrl = pokemon.sprites.front_default;
                    const types = pokemon.types.map(typeInfo => typeInfo.type.name);

                    pokemonCard.innerHTML = `
                        <div class="pokemon-id">#${id}</div>
                        <img src="${imageUrl}" alt="${name}">
                        <h2 class="pokemon-name">${name}</h2>
                        <div class="pokemon-types">
                            ${types.map(type => `<span class="type ${type}">${type}</span>`).join('')}
                        </div>
                    `;
                    pokedexContainer.appendChild(pokemonCard);
                });
            };

            // Displays the detailed info in the modal
            const showPokemonDetails = (pokemon) => {
                const id = pokemon.id.toString().padStart(3, '0');
                const name = pokemon.name;
                const imageUrl = pokemon.sprites.front_default;
                const types = pokemon.types.map(typeInfo => typeInfo.type.name);
                const height = (pokemon.height / 10).toFixed(1); // Decimeters to meters
                const weight = (pokemon.weight / 10).toFixed(1); // Hectograms to kilograms
                const abilities = pokemon.abilities.map(abilityInfo => abilityInfo.ability.name).join(', ');
                const stats = pokemon.stats.map(statInfo => ({
                    name: statInfo.stat.name.replace('-', ' '),
                    value: statInfo.base_stat
                }));
                
                modalBody.innerHTML = `
                    <div class="modal-info">
                        <img src="${imageUrl}" alt="${name}" class="modal-image">
                        <h2 class="modal-name">${name}</h2>
                        <div class="modal-id">#${id}</div>
                        <div class="modal-types">
                            ${types.map(type => `<span class="type ${type}">${type}</span>`).join('')}
                        </div>
                        <div class="details">
                            <p><strong>Height:</strong> ${height} m</p>
                            <p><strong>Weight:</strong> ${weight} kg</p>
                            <p><strong>Abilities:</strong> ${abilities}</p>
                        </div>
                        <h3>Base Stats</h3>
                        <ul class="stats-list">
                            ${stats.map(stat => `<li><span>${stat.name}</span><span>${stat.value}</span></li>`).join('')}
                        </ul>
                    </div>
                `;
                pokemonModal.style.display = 'block';
            };

            // Event listeners
            pokedexContainer.addEventListener('click', (e) => {
                const card = e.target.closest('.pokemon-card');
                if (card) {
                    const pokemonId = parseInt(card.getAttribute('data-id'));
                    const selectedPokemon = allPokemon.find(p => p.id === pokemonId);
                    if (selectedPokemon) {
                        showPokemonDetails(selectedPokemon);
                    }
                }
            });

            closeModal.addEventListener('click', () => {
                pokemonModal.style.display = 'none';
            });

            window.addEventListener('click', (e) => {
                if (e.target === pokemonModal) {
                    pokemonModal.style.display = 'none';
                }
            });

            searchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                const filteredPokemon = allPokemon.filter(pokemon => {
                    return pokemon.name.toLowerCase().includes(searchTerm) || 
                           pokemon.id.toString().includes(searchTerm);
                });
                displayPokemon(filteredPokemon);
            });

            // Initial fetch to populate the Pokédex
            fetchAllPokemon();
        });
    </script>
</body>
</html>
