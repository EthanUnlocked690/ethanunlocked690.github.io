<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATLAS: DATA FLOW CONSOLE v4.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        /* General Console Theme */
        body {
            background-color: #000;
            font-family: 'VT323', monospace;
            color: #00ff41; /* Console Green */
            font-size: 1.1rem;
            line-height: 1.4;
        }

        /* Simulated CRT/Scanline Effect (Optional but cool) */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            background: repeating-linear-gradient(
                #000, 
                #000 1px, 
                rgba(0, 255, 65, 0.08) 2px, 
                #000 3px
            );
            opacity: 0.8;
            z-index: -1;
        }

        .console-container {
            border: 3px solid #00ff41;
            box-shadow: 0 0 10px #00ff41;
            height: 95vh;
            display: flex;
            flex-direction: column;
            margin: 10px auto;
            max-width: 1000px;
        }

        /* Output Area */
        #output-area {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.9);
            white-space: pre-wrap; /* Preserve formatting for dynamic text */
        }

        /* Input Area */
        #input-line {
            padding: 1rem;
            border-top: 1px solid #00ff41;
            display: flex;
        }

        #input-prefix {
            color: #ff00ff; /* Magenta for the prompt */
        }

        #command-input {
            background: transparent;
            border: none;
            color: #00ff41;
            flex-grow: 1;
            outline: none;
            margin-left: 5px;
            font-family: 'VT323', monospace;
            font-size: 1.1rem;
        }

        /* Status Bar */
        #status-bar {
            background: #004d1a;
            color: #fff;
            padding: 0.5rem 1rem;
            text-align: right;
            font-size: 0.9rem;
        }

        /* Decrypt Mini-Game Elements */
        #decrypt-prompt {
            color: #ffff00; /* Yellow */
            font-size: 2rem;
            text-align: center;
            margin-bottom: 10px;
        }
        #decryption-input {
            width: 80%;
            background-color: #0a0a0a;
            border: 2px solid #ffff00;
            color: #fff;
            text-align: center;
            font-size: 1.5rem;
            margin: 0 auto;
            display: block;
            padding: 10px;
        }
    </style>
</head>
<body class="p-4">

    <div class="console-container">
        
        <div id="status-bar">
            ATLAS CONSOLE v4.0 | OPERATOR: E.I. | STATUS: ONLINE | DATABASE: STANDALONE
        </div>

        <div id="output-area">
            [[INITIATING ACCESS. . .]]<br>
            [[WELCOME, OPERATOR. LEVEL DELTA CLEARANCE CONFIRMED.]]<br>
            <br>
            Type **HELP** for available commands.
            <br>
        </div>

        <div id="input-line">
            <span id="input-prefix">ATLAS ></span>
            <input type="text" id="command-input" autofocus>
        </div>
        
    </div>

    <script>
        const outputArea = document.getElementById('output-area');
        const commandInput = document.getElementById('command-input');
        const statusPrefix = document.getElementById('input-prefix');

        const scanTargets = [
            "Project MIST: Status: Active, Latency: 12ms, Region: N/A",
            "Asset 701: Location: Dormant, Last Ping: 2025-09-12",
            "Encrypted Channel: ID: XULU404, Priority: High, Lock: Triple-Layered",
            "Sub-System TETHYS: State: Offline, Reason: Manual Disconnect",
            "OPERATOR LOG: E.I. (Ethan Ioannou) : Access Time Logged.",
            "Warning: Public Net Traceback attempted. Source blocked."
        ];

        let isScanning = false;
        let isDecrypting = false;
        let targetCode = '';
        let scanInterval;

        /**
         * Core utility to add output.
         */
        function writeOutput(text, color = '#00ff41') {
            const line = document.createElement('span');
            line.style.color = color;
            line.textContent = text;
            outputArea.appendChild(line);
            outputArea.appendChild(document.createElement('br'));
            outputArea.scrollTop = outputArea.scrollHeight;
        }
        
        /**
         * Simulation of a dynamic data scan.
         */
        function startScan() {
            if (isScanning) return;
            isScanning = true;
            writeOutput("INITIATING NETWORK SCAN... [MAY TAKE A MOMENT]", '#ffff00'); 
            
            let counter = 0;
            scanInterval = setInterval(() => {
                const randomTarget = scanTargets[Math.floor(Math.random() * scanTargets.length)];
                
                // Print 5 lines of random, glitching data before the real target
                for (let i = 0; i < 5; i++) {
                    const randomHex = Math.random().toString(16).substring(2, 10).toUpperCase();
                    writeOutput(`>> [${randomHex}]: DATA STREAM OVERLOAD...`, '#004d1a'); // Darker green for background noise
                }

                writeOutput(`>> TARGET FOUND: ${randomTarget}`, '#00ff41');

                counter++;
                if (counter >= 10) { // Scan for 10 cycles
                    clearInterval(scanInterval);
                    isScanning = false;
                    writeOutput("[SCAN COMPLETE]", '#ffff00');
                    showPrompt();
                }
            }, 500); // Faster refresh for visual effect
        }

        /**
         * Decryption mini-game logic.
         */
        function startDecryption() {
            if (isDecrypting) return;
            isDecrypting = true;
            
            // Generate a random 6-character hex code
            targetCode = Math.random().toString(16).substring(2, 8).toUpperCase();

            // Clear the command line area and display the game elements
            outputArea.innerHTML += `<br><div id="decryption-sequence"></div>`;
            const decryptionDiv = document.getElementById('decryption-sequence');
            
            decryptionDiv.innerHTML = `
                <div id="decrypt-prompt">**CODE INTRUSION DETECTED** - ENTER CODE TO RE-ROUTE</div>
                <div id="decrypt-code" style="font-size: 3rem; color: #ff0000; text-align: center; margin-bottom: 20px;">[ ${targetCode} ]</div>
                <input type="text" id="decryption-input" placeholder="TYPE THE CODE ABOVE QUICKLY">
                <div id="decrypt-timer" style="color: #fff; text-align: center; margin-top: 10px;">Time Remaining: 5.0s</div>
            `;
            
            // Temporarily hide the command input
            document.getElementById('input-line').style.display = 'none';

            const decryptInput = document.getElementById('decryption-input');
            const decryptTimer = document.getElementById('decrypt-timer');
            let timeRemaining = 5.0;
            
            decryptInput.focus();

            const timerInterval = setInterval(() => {
                timeRemaining -= 0.1;
                decryptTimer.textContent = `Time Remaining: ${timeRemaining.toFixed(1)}s`;

                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    handleDecryptionResult(false, decryptInput.value);
                }
            }, 100);

            decryptInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    clearInterval(timerInterval);
                    handleDecryptionResult(decryptInput.value.toUpperCase() === targetCode, decryptInput.value);
                }
            });
        }

        /**
         * Handles the result of the decryption mini-game.
         */
        function handleDecryptionResult(success, enteredCode) {
            isDecrypting = false;
            document.getElementById('input-line').style.display = 'flex';
            outputArea.removeChild(document.getElementById('decryption-sequence'));
            commandInput.focus();

            writeOutput(`> DECRYPT: Entered Code: ${enteredCode}`, '#ff00ff');

            if (success) {
                writeOutput(">> DECRYPTION SUCCESSFUL. Access to high-level network restored.", '#ffff00');
                writeOutput(">> KEY DATA DOWNLOADED: [ACCESS LOG: PROJECT CHIMERA (2025-10-09)]", '#00ff41');
            } else {
                writeOutput(">> DECRYPTION FAILED. Code Mismatch or Timeout. Security level raised.", '#ff0000');
            }
            showPrompt();
        }

        /**
         * Displays the input prompt.
         */
        function showPrompt() {
            // Ensure the prompt is only written if not mid-game
            if (!isScanning && !isDecrypting) {
                writeOutput("", '#00ff41'); // Newline
                commandInput.value = '';
            }
        }

        /**
         * Processes the user's command.
         */
        function processCommand(command) {
            command = command.trim().toUpperCase();
            writeOutput(`> ${command}`, '#ff00ff'); // Echo the command
            
            if (isScanning || isDecrypting) {
                writeOutput("!! System Busy. Please wait for current sequence to finish.", '#ff0000');
                return;
            }

            switch (command) {
                case 'HELP':
                    writeOutput("--- AVAILABLE COMMANDS ---", '#ffff00');
                    writeOutput("SCAN    : Initiate deep-level network and asset scan.", '#00ff41');
                    writeOutput("DECRYPT : Initiate emergency decryption sequence (Mini-Game).", '#00ff41');
                    writeOutput("LOGOUT  : Terminate session and return to main site.", '#00ff41');
                    break;
                case 'SCAN':
                    startScan();
                    return;
                case 'DECRYPT':
                    startDecryption();
                    return;
                case 'LOGOUT':
                    writeOutput("SESSION TERMINATED. Clearing logs...", '#ff0000');
                    setTimeout(() => {
                        window.location.href = 'index.html';
                    }, 1000);
                    return;
                case 'ETHAN':
                case 'IOANNOU':
                    writeOutput("QUERY VIOLATION. RE-QUERY PROTOCOL 3.01. LOGGING INCIDENT.", '#ff0000');
                    break;
                default:
                    writeOutput(`ERROR: Command '${command}' not recognized. Try HELP.`, '#ff0000');
                    break;
            }
            showPrompt();
        }

        // --- Event Listeners ---

        commandInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                if (isDecrypting) return; // Prevent interference with decryption game
                processCommand(commandInput.value);
                commandInput.value = '';
            }
        });

        // Initialize on load
        window.onload = function() {
            commandInput.focus();
        };
    </script>
</body>
</html>
